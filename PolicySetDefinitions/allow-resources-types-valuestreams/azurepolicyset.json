{
  "type": "Microsoft.Authorization/policySetDefinitions",
  "name": "allowed-resources-types-valuestreams",
  "Properties": {
    "displayName": "Allowed resource types for value streams",
    "description": "Allowed resource types for value streams - https://confluence.devops.lloydsbanking.com/display/PCE/Allowed+Resource+Types",
    "metadata": {
      "category": "General"
    },
    "parameters": {
      
    },
    "policyDefinitions": [
      {
        "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/3ded2960-214a-46ff-8cf4-611f125e2398/providers/Microsoft.Authorization/policyDefinitions/allowed-resource-types",
        "parameters": {
          "listOfResourceTypesAllowed": {
            "value": [
              "Microsoft.Automation/automationAccounts",
              "Microsoft.Automation/automationAccounts/configurations",
              "Microsoft.Automation/automationAccounts/jobs",
              "Microsoft.Automation/automationAccounts/runbooks",
              "Microsoft.Automation/automationAccounts/softwareUpdateConfigurations",
              "Microsoft.Automation/automationAccounts/variables",
              "Microsoft.Automation/automationAccounts/webhooks",
              "Microsoft.Automation/operations",
              "Microsoft.Compute/availabilitySets",
              "Microsoft.Compute/disks",
              "Microsoft.Compute/locations",
              "Microsoft.Compute/locations/artifactPublishers",
              "Microsoft.Compute/locations/capsoperations",
              "Microsoft.Compute/locations/diskoperations",
              "Microsoft.Compute/locations/logAnalytics",
              "Microsoft.Compute/locations/operations",
              "Microsoft.Compute/locations/publishers",
              "Microsoft.Compute/locations/runCommands",
              "Microsoft.Compute/locations/usages",
              "Microsoft.Compute/locations/virtualMachines",
              "Microsoft.Compute/locations/vmSizes",
              "Microsoft.Compute/operations",
              "Microsoft.Compute/restorePointCollections",
              "Microsoft.Compute/restorePointCollections/restorePoints",
              "Microsoft.Compute/snapshots",
              "Microsoft.Compute/virtualMachines",
              "Microsoft.Compute/virtualMachines/diagnosticSettings",
              "Microsoft.Compute/virtualMachines/extensions",
              "Microsoft.Compute/virtualMachines/metricDefinitions",
              "Microsoft.Compute/virtualMachineScaleSets",
              "Microsoft.Compute/virtualMachineScaleSets/extensions",
              "Microsoft.Compute/virtualMachineScaleSets/networkInterfaces",
              "Microsoft.Compute/virtualMachineScaleSets/virtualMachines",
              "Microsoft.Compute/virtualMachineScaleSets/virtualMachines/networkInterfaces",
              "Microsoft.DevTestLab/schedules",
              "microsoft.insights/components",
              "microsoft.insights/components/query",
              "microsoft.insights/components/metrics",
              "microsoft.insights/components/events",
              "microsoft.insights/webtests",
              "microsoft.insights/queries",
              "microsoft.insights/scheduledqueryrules",
              "microsoft.insights/components/pricingPlans",
              "microsoft.insights/migrateToNewPricingModel",
              "microsoft.insights/rollbackToLegacyPricingModel",
              "microsoft.insights/listMigrationdate",
              "microsoft.insights/logprofiles",
              "microsoft.insights/metricalerts",
              "microsoft.insights/alertrules",
              "microsoft.insights/autoscalesettings",
              "microsoft.insights/eventtypes",
              "microsoft.insights/locations",
              "microsoft.insights/locations/operationResults",
              "microsoft.insights/operations",
              "microsoft.insights/automatedExportSettings",
              "microsoft.insights/diagnosticSettings",
              "microsoft.insights/diagnosticSettingsCategories",
              "microsoft.insights/extendedDiagnosticSettings",
              "microsoft.insights/metricDefinitions",
              "microsoft.insights/logDefinitions",
              "microsoft.insights/eventCategories",
              "microsoft.insights/metrics",
              "microsoft.insights/metricNamespaces",
              "microsoft.insights/actiongroups",
              "microsoft.insights/activityLogAlerts",
              "microsoft.insights/baseline",
              "microsoft.insights/calculatebaseline",
              "microsoft.insights/workbooks",
              "microsoft.insights/myWorkbooks",
              "microsoft.insights/logs",
              "Microsoft.KeyVault/vaults",
              "Microsoft.KeyVault/vaults/secrets",
              "Microsoft.KeyVault/vaults/accessPolicies",
              "Microsoft.KeyVault/operations",
              "Microsoft.KeyVault/checkNameAvailability",
              "Microsoft.KeyVault/deletedVaults",
              "Microsoft.KeyVault/locations",
              "Microsoft.KeyVault/locations/deletedVaults",
              "Microsoft.KeyVault/locations/deleteVirtualNetworkOrSubnets",
              "Microsoft.KeyVault/locations/operationResults",
              "Microsoft.LogAnalytics/logs",
              "Microsoft.LogAnalytics/operations",
              "Microsoft.Network/applicationSecurityGroups",
              "Microsoft.Network/connections",
              "Microsoft.Network/loadBalancers",
              "Microsoft.Network/networkInterfaces",
              "Microsoft.Network/networkSecurityGroups",
              "Microsoft.Network/networkWatchers",
              "Microsoft.Network/networkWatchers/connectionMonitors",
              "Microsoft.Network/networkWatchers/lenses",
              "Microsoft.Network/networkWatchers/pingMeshes",
              "Microsoft.Network/routeTables",
              "Microsoft.Network/virtualNetworks",
              "Microsoft.OperationalInsights/workspaces",
              "Microsoft.OperationalInsights/workspaces/query",
              "Microsoft.OperationalInsights/workspaces/dataSources",
              "Microsoft.OperationalInsights/storageInsightConfigs",
              "Microsoft.OperationalInsights/workspaces/linkedServices",
              "Microsoft.OperationalInsights/linkTargets",
              "Microsoft.OperationalInsights/operations",
              "Microsoft.OperationalInsights/devices",
              "Microsoft.OperationsManagement/solutions",
              "Microsoft.OperationsManagement/managementconfigurations",
              "Microsoft.OperationsManagement/managementassociations",
              "Microsoft.OperationsManagement/views",
              "Microsoft.OperationsManagement/operations",
              "Microsoft.RecoveryServices/vaults",
              "Microsoft.RecoveryServices/operations",
              "Microsoft.RecoveryServices/locations",
              "Microsoft.RecoveryServices/locations/backupStatus",
              "Microsoft.RecoveryServices/locations/allocatedStamp",
              "Microsoft.RecoveryServices/locations/allocateStamp",
              "Microsoft.RecoveryServices/locations/backupValidateFeatures",
              "Microsoft.RecoveryServices/locations/backupPreValidateProtection",
              "Microsoft.RecoveryServices/backupProtectedItems",
              "Microsoft.Resources/resourceGroups",
              "Microsoft.Resources/subscriptions/resourceGroups",
              "Microsoft.Sql/checkNameAvailability",
              "Microsoft.Sql/locations",
              "Microsoft.Sql/locations/administratorAzureAsyncOperation",
              "Microsoft.Sql/locations/administratorOperationResults",
              "Microsoft.Sql/locations/auditingSettingsAzureAsyncOperation",
              "Microsoft.Sql/locations/auditingSettingsOperationResults",
              "Microsoft.Sql/locations/capabilities",
              "Microsoft.Sql/locations/databaseAzureAsyncOperation",
              "Microsoft.Sql/locations/databaseOperationResults",
              "Microsoft.Sql/locations/databaseRestoreAzureAsyncOperation",
              "Microsoft.Sql/locations/deletedServerAsyncOperation",
              "Microsoft.Sql/locations/deletedServerOperationResults",
              "Microsoft.Sql/locations/deletedServers",
              "Microsoft.Sql/locations/deleteVirtualNetworkOrSubnets",
              "Microsoft.Sql/locations/deleteVirtualNetworkOrSubnetsAzureAsyncOperation",
              "Microsoft.Sql/locations/deleteVirtualNetworkOrSubnetsOperationResults",
              "Microsoft.Sql/locations/dnsAliasAsyncOperation",
              "Microsoft.Sql/locations/dnsAliasOperationResults",
              "Microsoft.Sql/locations/elasticPoolAzureAsyncOperation",
              "Microsoft.Sql/locations/elasticPoolOperationResults",
              "Microsoft.Sql/locations/encryptionProtectorAzureAsyncOperation",
              "Microsoft.Sql/locations/encryptionProtectorOperationResults",
              "Microsoft.Sql/locations/extendedAuditingSettingsAzureAsyncOperation",
              "Microsoft.Sql/locations/extendedAuditingSettingsOperationResults",
              "Microsoft.Sql/locations/failoverGroupAzureAsyncOperation",
              "Microsoft.Sql/locations/failoverGroupOperationResults",
              "Microsoft.Sql/locations/firewallRulesAzureAsyncOperation",
              "Microsoft.Sql/locations/firewallRulesOperationResults",
              "Microsoft.Sql/locations/instanceFailoverGroupAzureAsyncOperation",
              "Microsoft.Sql/locations/instanceFailoverGroupOperationResults",
              "Microsoft.Sql/locations/instanceFailoverGroups",
              "Microsoft.Sql/locations/interfaceEndpointProfileAzureAsyncOperation",
              "Microsoft.Sql/locations/interfaceEndpointProfileOperationResults",
              "Microsoft.Sql/locations/jobAgentAzureAsyncOperation",
              "Microsoft.Sql/locations/jobAgentOperationResults",
              "Microsoft.Sql/locations/longTermRetentionBackupAzureAsyncOperation",
              "Microsoft.Sql/locations/longTermRetentionBackupOperationResults",
              "Microsoft.Sql/locations/longTermRetentionBackups",
              "Microsoft.Sql/locations/longTermRetentionPolicyAzureAsyncOperation",
              "Microsoft.Sql/locations/longTermRetentionPolicyOperationResults",
              "Microsoft.Sql/locations/longTermRetentionServers",
              "Microsoft.Sql/locations/managedDatabaseAzureAsyncOperation",
              "Microsoft.Sql/locations/managedDatabaseOperationResults",
              "Microsoft.Sql/locations/managedDatabaseRestoreAzureAsyncOperation",
              "Microsoft.Sql/locations/securityAlertPoliciesAzureAsyncOperation",
              "Microsoft.Sql/locations/securityAlertPoliciesOperationResults",
              "Microsoft.Sql/locations/serverAzureAsyncOperation",
              "Microsoft.Sql/locations/serverKeyAzureAsyncOperation",
              "Microsoft.Sql/locations/serverKeyOperationResults",
              "Microsoft.Sql/locations/serverOperationResults",
              "Microsoft.Sql/locations/shortTermRetentionPolicyAzureAsyncOperation",
              "Microsoft.Sql/locations/shortTermRetentionPolicyOperationResults",
              "Microsoft.Sql/locations/syncAgentOperationResults",
              "Microsoft.Sql/locations/syncDatabaseIds",
              "Microsoft.Sql/locations/syncGroupOperationResults",
              "Microsoft.Sql/locations/syncMemberOperationResults",
              "Microsoft.Sql/locations/tdeCertAzureAsyncOperation",
              "Microsoft.Sql/locations/tdeCertOperationResults",
              "Microsoft.Sql/locations/usages",
              "Microsoft.Sql/locations/virtualNetworkRulesAzureAsyncOperation",
              "Microsoft.Sql/locations/virtualNetworkRulesOperationResults",
              "Microsoft.Sql/locations/vulnerabilityAssessmentScanAzureAsyncOperation",
              "Microsoft.Sql/locations/vulnerabilityAssessmentScanOperationResults",
              "Microsoft.Sql/operations",
              "Microsoft.Sql/servers",
              "Microsoft.Sql/servers/administratorOperationResults",
              "Microsoft.Sql/servers/administrators",
              "Microsoft.Sql/servers/advisors",
              "Microsoft.Sql/servers/aggregatedDatabaseMetrics",
              "Microsoft.Sql/servers/auditingPolicies",
              "Microsoft.Sql/servers/auditingSettings",
              "Microsoft.Sql/servers/automaticTuning",
              "Microsoft.Sql/servers/backupLongTermRetentionVaults",
              "Microsoft.Sql/servers/communicationLinks",
              "Microsoft.Sql/servers/connectionPolicies",
              "Microsoft.Sql/servers/databases",
              "Microsoft.Sql/servers/databases/advisors",
              "Microsoft.Sql/servers/databases/auditingPolicies",
              "Microsoft.Sql/servers/databases/auditingSettings",
              "Microsoft.Sql/servers/databases/auditRecords",
              "Microsoft.Sql/servers/databases/automaticTuning",
              "Microsoft.Sql/servers/databases/backupLongTermRetentionPolicies",
              "Microsoft.Sql/servers/databases/connectionPolicies",
              "Microsoft.Sql/servers/databases/dataMaskingPolicies",
              "Microsoft.Sql/servers/databases/dataMaskingPolicies/rules",
              "Microsoft.Sql/servers/databases/extensions",
              "Microsoft.Sql/servers/databases/geoBackupPolicies",
              "Microsoft.Sql/servers/databases/metricDefinitions",
              "Microsoft.Sql/servers/databases/metrics",
              "Microsoft.Sql/servers/databases/recommendedSensitivityLabels",
              "Microsoft.Sql/servers/databases/securityAlertPolicies",
              "Microsoft.Sql/servers/databases/syncGroups",
              "Microsoft.Sql/servers/databases/syncGroups/syncMembers",
              "Microsoft.Sql/servers/databases/topQueries",
              "Microsoft.Sql/servers/databases/topQueries/queryText",
              "Microsoft.Sql/servers/databases/transparentDataEncryption",
              "Microsoft.Sql/servers/databases/VulnerabilityAssessment",
              "Microsoft.Sql/servers/databases/vulnerabilityAssessments",
              "Microsoft.Sql/servers/databases/VulnerabilityAssessmentScans",
              "Microsoft.Sql/servers/databases/VulnerabilityAssessmentSettings",
              "Microsoft.Sql/servers/databaseSecurityPolicies",
              "Microsoft.Sql/servers/disasterRecoveryConfiguration",
              "Microsoft.Sql/servers/dnsAliases",
              "Microsoft.Sql/servers/elasticPoolEstimates",
              "Microsoft.Sql/servers/elasticpools",
              "Microsoft.Sql/servers/elasticPools/advisors",
              "Microsoft.Sql/servers/elasticpools/metricdefinitions",
              "Microsoft.Sql/servers/elasticpools/metrics",
              "Microsoft.Sql/servers/encryptionProtector",
              "Microsoft.Sql/servers/extendedAuditingSettings",
              "Microsoft.Sql/servers/failoverGroups",
              "Microsoft.Sql/servers/import",
              "Microsoft.Sql/servers/importExportOperationResults",
              "Microsoft.Sql/servers/interfaceEndpointProfiles",
              "Microsoft.Sql/servers/keys",
              "Microsoft.Sql/servers/operationResults",
              "Microsoft.Sql/servers/recommendedElasticPools",
              "Microsoft.Sql/servers/recoverableDatabases",
              "Microsoft.Sql/servers/restorableDroppedDatabases",
              "Microsoft.Sql/servers/securityAlertPolicies",
              "Microsoft.Sql/servers/serviceObjectives",
              "Microsoft.Sql/servers/syncAgents",
              "Microsoft.Sql/servers/tdeCertificates",
              "Microsoft.Sql/servers/usages",
              "Microsoft.Sql/servers/virtualNetworkRules",
              "Microsoft.Sql/servers/vulnerabilityAssessments",
              "Microsoft.Sql/virtualClusters",
              "Microsoft.Storage/storageAccounts",
              "Microsoft.Storage/operations",
              "Microsoft.Storage/locations/asyncoperations",
              "Microsoft.Storage/storageAccounts/listAccountSas",
              "Microsoft.Storage/storageAccounts/listServiceSas",
              "Microsoft.Storage/storageAccounts/blobServices",
              "Microsoft.Storage/storageAccounts/tableServices",
              "Microsoft.Storage/locations",
              "Microsoft.Storage/locations/usages",
              "Microsoft.Storage/locations/deleteVirtualNetworkOrSubnets",
              "Microsoft.Storage/usages",
              "Microsoft.Storage/checkNameAvailability",
              "Microsoft.Storage/storageAccounts/services",
              "Microsoft.Storage/storageAccounts/services/metricDefinitions"
            ]
          },
          "effect": {
            "value": "Deny"
          }
        }
      }
    ]
  }
}
